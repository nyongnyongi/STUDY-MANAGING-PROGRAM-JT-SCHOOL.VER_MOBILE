<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="format-detection" content="telephone=no">
    <title>JT School 열품타</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🐕</text></svg>">
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <span class="mascot">🐕</span>
                <h1>JT SCHOOL - 코기와 함께하는 공부 기록</h1>
                <span class="live-indicator" id="live-indicator" style="display: none;">● LIVE</span>
            </div>
            <nav class="nav" id="main-navigation" role="navigation" aria-label="메인 네비게이션">
                <button class="nav-btn active" data-tab="timer" aria-pressed="true">공부 타이머</button>
                <button class="nav-btn" data-tab="timeline" aria-pressed="false">학습 타임라인</button>
                <button class="nav-btn" data-tab="writing-coach" aria-pressed="false">글쓰기 코치</button>
                <button class="nav-btn" data-tab="settings" aria-pressed="false">설정</button>
            </nav>
            <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="모바일 메뉴 열기/닫기" aria-expanded="false" aria-controls="main-navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>

    <!-- 로그인/회원가입 화면 -->
    <div id="login-screen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <span class="mascot">🐕</span>
                <h2>JT SCHOOL에 오신 것을 환영합니다!</h2>
                <p>계정을 만들어 학습 기록을 영구 보존하세요</p>
            </div>
            
            <!-- 로그인 폼 -->
            <form class="login-form active" id="login-form">
                <h3>로그인</h3>
                <div class="form-group">
                    <label for="login-username">사용자명</label>
                    <input type="text" id="login-username" placeholder="사용자명을 입력하세요" required>
                </div>
                <div class="form-group">
                    <label for="login-password">비밀번호</label>
                    <input type="password" id="login-password" placeholder="비밀번호를 입력하세요" required>
                </div>
                <button type="submit" class="login-btn">로그인</button>
                <p class="form-switch">
                    계정이 없으신가요? <a href="#" id="show-register">회원가입</a>
                </p>
                <button type="button" id="debug-users" style="margin-top: 10px; padding: 5px 10px; font-size: 12px; background: #ccc;">사용자 목록 확인</button>
            </form>
            
            <!-- 회원가입 폼 -->
            <form class="register-form" id="register-form">
                <h3>회원가입</h3>
                <div class="form-group">
                    <label for="register-username">사용자명</label>
                    <input type="text" id="register-username" placeholder="3자 이상 입력하세요" required>
                    <small>사용자명은 영문, 숫자, 한글, 언더스코어(_)만 사용 가능합니다</small>
                </div>
                <div class="form-group">
                    <label for="register-password">비밀번호</label>
                    <input type="password" id="register-password" placeholder="6자 이상 입력하세요" required>
                    <small>비밀번호는 6자 이상이어야 합니다</small>
                </div>
                <div class="form-group">
                    <label for="register-confirm-password">비밀번호 확인</label>
                    <input type="password" id="register-confirm-password" placeholder="비밀번호를 다시 입력하세요" required>
                </div>
                <button type="submit" class="login-btn">회원가입</button>
                <p class="form-switch">
                    이미 계정이 있으신가요? <a href="#" id="show-login">로그인</a>
                </p>
            </form>
        </div>
    </div>

    <main class="main" id="main-content" style="display: none;">
        <!-- 공부 타이머 탭 -->
        <section id="timer" class="tab-content active">
            <div class="timer-container">
                <!-- 일일 목표 설정 -->
                <div class="daily-goal-section">
                    <h3>오늘의 목표</h3>
                    <div class="goal-input-group">
                        <input type="number" id="daily-goal-hours" placeholder="0" min="0" max="24" aria-label="목표 시간 (시간)">
                        <span class="goal-unit">시간</span>
                        <input type="number" id="daily-goal-minutes" placeholder="0" min="0" max="59" aria-label="목표 시간 (분)">
                        <span class="goal-unit">분</span>
                        <button class="goal-set-btn" id="set-daily-goal">목표 설정</button>
                    </div>
                    <div class="goal-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="goal-progress-fill"></div>
                        </div>
                        <div class="goal-status" id="goal-status">목표를 설정해주세요</div>
                    </div>
                </div>

                <!-- 휴식하기 버튼 -->
                <div class="timer-controls" role="group" aria-label="타이머 컨트롤">
                    <button class="control-btn rest-btn" id="rest-btn" aria-label="휴식하기">휴식하기</button>
                </div>

                <!-- 과목 생성 및 관리 -->
                <div class="subject-management">
                    <h3>과목 생성 및 관리</h3>
                    <div class="subject-create-form">
                        <div class="form-group">
                            <label for="new-subject-name">과목 이름</label>
                            <input type="text" id="new-subject-name" placeholder="예: 수학 2-2, 영어 문법" maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="new-subject-tag">태그</label>
                            <select id="new-subject-tag">
                                <option value="">태그 선택</option>
                                <option value="국어">국어</option>
                                <option value="수학">수학</option>
                                <option value="영어">영어</option>
                                <option value="사회">사회</option>
                                <option value="과학">과학</option>
                                <option value="기타">기타</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>색상</label>
                            <div class="color-info">색상은 자동으로 할당됩니다</div>
                        </div>
                        <button class="create-subject-btn" id="create-subject-btn">과목 생성</button>
                    </div>
                </div>

                <!-- 과목별 개별 타이머 -->
                <div class="subject-timers">
                    <h3>과목별 개별 타이머</h3>
                    <div id="subject-timers" class="subject-timers-grid">
                        <!-- 과목별 타이머가 여기에 동적으로 추가됩니다 -->
                    </div>
                </div>

                <!-- 전체 통계 -->
                <div class="total-stats">
                    <h3>전체 통계</h3>
                    <div class="total-time-display">
                        <span class="total-label">총 공부 시간:</span>
                        <span class="total-time" id="total-study-time">00:00:00</span>
                    </div>
                </div>
                
                <!-- 통계 위젯 -->
                <div class="stats-widgets">
                    <div class="stat-widget">
                        <h4>오늘 합계</h4>
                        <div class="stat-value" id="today-total">00:00:00</div>
                        <div class="mini-chart" id="today-mini-chart"></div>
                    </div>
                    <div class="stat-widget">
                        <h4>주간 합계</h4>
                        <div class="stat-value" id="weekly-total">00:00:00</div>
                        <div class="mini-chart" id="weekly-mini-chart"></div>
                    </div>
                </div>
                

            </div>
        </section>

        <!-- 학습 타임라인 탭 -->
        <section id="timeline" class="tab-content">
            <div class="timeline-container">
                <div class="timeline-header">
                    <h2>학습 타임라인</h2>
                </div>
                
                <!-- 태그별 학습 히트맵 (Git Contribution 스타일) -->
                <div class="tag-heatmaps-section">
                    <h3>태그별 학습 히트맵</h3>
                    <div class="tag-heatmaps">
                        <!-- 국어 히트맵 -->
                        <div class="tag-heatmap-card">
                            <h4>국어</h4>
                            <div class="tag-heatmap-grid" id="tag-heatmap-국어"></div>
                        </div>
                        
                        <!-- 수학 히트맵 -->
                        <div class="tag-heatmap-card">
                            <h4>수학</h4>
                            <div class="tag-heatmap-grid" id="tag-heatmap-수학"></div>
                        </div>
                        
                        <!-- 영어 히트맵 -->
                        <div class="tag-heatmap-card">
                            <h4>영어</h4>
                            <div class="tag-heatmap-grid" id="tag-heatmap-영어"></div>
                        </div>
                        
                        <!-- 사회 히트맵 -->
                        <div class="tag-heatmap-card">
                            <h4>사회</h4>
                            <div class="tag-heatmap-grid" id="tag-heatmap-사회"></div>
                        </div>
                        
                        <!-- 과학 히트맵 -->
                        <div class="tag-heatmap-card">
                            <h4>과학</h4>
                            <div class="tag-heatmap-grid" id="tag-heatmap-과학"></div>
                        </div>
                    </div>
                    
                    <div class="tag-heatmap-legend">
                        <span class="legend-item"><span class="legend-box level-0"></span> 0분</span>
                        <span class="legend-item"><span class="legend-box level-1"></span> 1-30분</span>
                        <span class="legend-item"><span class="legend-box level-2"></span> 30분-1시간</span>
                        <span class="legend-item"><span class="legend-box level-3"></span> 1-2시간</span>
                        <span class="legend-item"><span class="legend-box level-4"></span> 2시간 이상</span>
                    </div>
                </div>
                
                <!-- 과목별 히트맵 -->
                <div class="subject-heatmaps-section">
                    <h3>과목별 학습 기록</h3>
                    <div id="subject-heatmaps" class="subject-heatmaps">
                        <!-- 과목별 히트맵이 여기에 동적으로 추가됩니다 -->
                    </div>

                </div>
                
                <!-- 통계 요약 -->
                <div class="timeline-stats">
                    <div class="stat-card">
                        <h3>이번 주</h3>
                        <div class="stat-value" id="weekly-time">00:00:00</div>
                    </div>
                    <div class="stat-card">
                        <h3>이번 달</h3>
                        <div class="stat-value" id="monthly-time">00:00:00</div>
                    </div>
                    <div class="stat-card">
                        <h3>연속 학습</h3>
                        <div class="stat-value" id="streak">0일</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 글쓰기 코치 탭 -->
        <section id="writing-coach" class="tab-content">
            <div class="coach-container">
                <h2>글쓰기 코치 🐕</h2>
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages" role="log" aria-label="채팅 메시지">
                        <div class="message coach-message">
                            안녕하세요! 저는 코기 글쓰기 코치입니다. 
                            글쓰기에 대한 질문이나 고민이 있으시면 언제든 말씀해주세요! 🐕
                        </div>
                    </div>
                    <div class="chat-input" role="group" aria-label="메시지 입력">
                        <input type="text" id="chat-input" placeholder="글쓰기에 대해 질문해보세요..." aria-label="메시지 입력">
                        <button id="send-btn" aria-label="메시지 전송">전송</button>
                    </div>
                </div>
                
                <!-- 프리셋 질문 버튼 -->
                <div class="preset-questions">
                    <h3>빠른 시작</h3>
                    <div class="preset-buttons" role="group" aria-label="프리셋 질문">
                        <button class="preset-btn" data-question="장면부터 시작하려면 어떻게 해야 하나요?" aria-label="장면부터 시작하기">장면부터 시작</button>
                        <button class="preset-btn" data-question="감정을 고르는 방법을 알려주세요" aria-label="감정 고르기">감정 고르기</button>
                        <button class="preset-btn" data-question="비유 연습은 어떻게 하나요?" aria-label="비유 연습">비유 연습</button>
                        <button class="preset-btn" data-question="독서 메모는 어떻게 써야 하나요?" aria-label="독서 메모">독서 메모</button>
                    </div>
                </div>
                
                <div class="quick-questions">
                    <h3>자주 묻는 질문</h3>
                    <div class="question-buttons" role="group" aria-label="자주 묻는 질문">
                        <button class="quick-q-btn" data-question="글을 시작하려니 A4가 너무 커 보여요. 뭐부터 쓰죠?" aria-label="글 시작하기">글 시작하기</button>
                        <button class="quick-q-btn" data-question="경험이 없어요. 학교-급식-학원뿐인데요" aria-label="경험 부족">경험 부족</button>
                        <button class="quick-q-btn" data-question="좋은 문장 비결 있나요?" aria-label="좋은 문장">좋은 문장</button>
                        <button class="quick-q-btn" data-question="비유는 어떻게 써요? 식상해질까 봐요" aria-label="비유 쓰기">비유 쓰기</button>
                        <button class="quick-q-btn" data-question="독서는 왜 필요하죠?" aria-label="독서 필요성">독서 필요성</button>
                        <button class="quick-q-btn" data-question="글 공포를 빨리 줄이는 루틴 알려주세요" aria-label="글 공포 극복">글 공포 극복</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- 설정 탭 -->
        <section id="settings" class="tab-content">
            <div class="settings-container">
                <h2>설정 및 내보내기</h2>
                <div class="settings-group">
                    <h3>알림 설정</h3>
                    <label class="setting-item">
                        <input type="checkbox" id="sound-notification" checked aria-describedby="sound-notification-desc">
                        <span>소리 알림</span>
                        <div id="sound-notification-desc" class="sr-only">타이머 완료 시 소리로 알림을 받습니다</div>
                    </label>
                    <label class="setting-item">
                        <input type="checkbox" id="browser-notification" checked aria-describedby="browser-notification-desc">
                        <span>브라우저 알림</span>
                        <div id="browser-notification-desc" class="sr-only">타이머 완료 시 브라우저 알림을 받습니다</div>
                    </label>
                    <label class="setting-item">
                        <input type="checkbox" id="auto-pause" aria-describedby="auto-pause-desc">
                        <span>자동 일시정지</span>
                        <div id="auto-pause-desc" class="sr-only">브라우저 숨김 시 자동으로 타이머를 일시정지합니다</div>
                    </label>
                </div>
                <div class="settings-group">
                    <h3>데이터 관리</h3>
                    <button class="export-btn" id="export-data" aria-describedby="export-data-desc">데이터 내보내기</button>
                    <div id="export-data-desc" class="sr-only">현재 학습 데이터를 JSON 파일로 다운로드합니다</div>
                    <button class="import-btn" id="import-data" aria-describedby="import-data-desc">데이터 가져오기</button>
                    <div id="import-data-desc" class="sr-only">이전에 내보낸 학습 데이터를 가져옵니다</div>
                    <input type="file" id="import-file" accept=".json" style="display: none;" aria-label="데이터 파일 선택">
                    <button class="clear-btn" id="clear-data" aria-describedby="clear-data-desc">데이터 초기화</button>
                    <div id="clear-data-desc" class="sr-only">모든 학습 데이터를 영구적으로 삭제합니다</div>
                </div>
                <div class="settings-group">
                    <h3>계정 관리</h3>
                    <div class="user-info">
                        <p>현재 사용자: <strong id="current-user-display"></strong></p>
                    </div>
                    <button class="logout-btn" id="logout-btn" aria-describedby="logout-btn-desc">로그아웃</button>
                    <div id="logout-btn-desc" class="sr-only">현재 계정에서 로그아웃하고 다른 계정으로 로그인할 수 있습니다</div>
                </div>
                <div class="settings-group">
                    <h3>글쓰기 코치 설정</h3>
                    <div class="form-group">
                        <label for="gemini-api-key">제미나이 API 키</label>
                        <input type="password" id="gemini-api-key" placeholder="API 키를 입력하세요" aria-describedby="api-key-desc">
                        <div id="api-key-desc" class="sr-only">제미나이 API 키를 입력하면 더 정확한 글쓰기 조언을 받을 수 있습니다</div>
                        <small>API 키가 없어도 기본 글쓰기 조언을 받을 수 있습니다</small>
                    </div>
                    <button class="btn btn-primary" id="save-api-key">API 키 저장</button>
                </div>
                <div class="settings-group">
                    <h3>테마 설정</h3>
                    <div class="theme-options" role="radiogroup" aria-label="테마 선택">
                        <label class="theme-option">
                            <input type="radio" name="theme" value="default" checked aria-describedby="default-theme-desc">
                            <span class="theme-preview default-theme" aria-hidden="true"></span>
                            <span>기본 테마</span>
                            <div id="default-theme-desc" class="sr-only">밝은 배경의 기본 테마입니다</div>
                        </label>
                        <label class="theme-option">
                            <input type="radio" name="theme" value="dark" aria-describedby="dark-theme-desc">
                            <span class="theme-preview dark-theme" aria-hidden="true"></span>
                            <span>다크 모드</span>
                            <div id="dark-theme-desc" class="sr-only">어두운 배경의 다크 테마입니다</div>
                        </label>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>&copy; 2025 JT SCHOOL 타이머. 코기와 함께하는 효율적인 공부 시간!</p>
    </footer>
    <!-- 목표 추가/편집 모달 -->
    <div class="modal" id="goal-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">목표 추가</h3>
                <button class="modal-close" id="modal-close" aria-label="모달 닫기">&times;</button>
            </div>
            <div class="modal-body">
                <form id="goal-form">
                    <div class="form-group">
                        <label for="goal-title">목표 제목</label>
                        <input type="text" id="goal-title" required maxlength="100">
                    </div>
                    <div class="form-group">
                        <label for="goal-stage">단계</label>
                        <select id="goal-stage" required>
                            <option value="계획됨">계획됨</option>
                            <option value="진행중">진행중</option>
                            <option value="완료">완료</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="goal-date">목표 날짜</label>
                        <input type="date" id="goal-date" required>
                    </div>
                    <div class="form-group">
                        <label for="goal-tag">태그</label>
                        <select id="goal-tag">
                            <option value="">태그 선택</option>
                            <option value="수학">수학</option>
                            <option value="영어">영어</option>
                            <option value="과학">과학</option>
                            <option value="코딩">코딩</option>
                            <option value="국어">국어</option>
                            <option value="사회">사회</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="goal-memo">메모</label>
                        <textarea id="goal-memo" rows="3" maxlength="500" placeholder="목표에 대한 추가 설명이나 계획을 작성하세요"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="modal-cancel">취소</button>
                <button type="submit" class="btn btn-primary" form="goal-form">저장</button>
            </div>
        </div>
    </div>

    <!-- 토스트 알림 컨테이너 -->
    <div class="toast-container" id="toast-container"></div>

    <script src="script.js"></script>
</body>
</html>
